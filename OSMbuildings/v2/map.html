<!DOCTYPE html>
<html>
<head>
	<title>3DPeral</title>
	<meta name="description" content="3D visualisations of buildings in London 
                        using UKMap data with leaflet and OSM Buildings.">
	<meta name="author" content="Tom Holderness">
	<meta name="version" content="0.1">
	
	<!--JQuery library to handle JSON requests-->
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="osm_geojson.js"></script>
   	<!--JQuery extension to handle JSON requests using AJAX post request-->
	<!--Credit to: http://forum.jquery.com/topic/getjson-using-post -->


	<!--Leaflet map library (hosted version)-->
	<script src="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.js"></script>

	<!--OSM Buildings library-->
	<script src="L.BuildingsLayer.js"></script>

	<!--Styles and CSS-->
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.css"/>
	<!--[if lte IE 8]>
    	<	link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.ie.css" />
	<![endif]-->

	<style>
	body {
		padding: 0;
		margin: 0;
	}
	html, body, #map {
		height: 100%;
	}
	
   </style>
</head>

	<body>


	<div id="map"></div>
	<script>
	var geojsonData;
	$.getJSON( "../map.geojson", function( data ) {
		osmData = data;
		console.log('ok')
	})
		
	//var geojsonData = osm_geojson.osm2geojson(osmData)

	//Request data from GeoJson server and add to map
	function getBuildings(data){
 
			build
        		.addTo(map)
		        .setStyle({ wallColor: 'rgb(200,190,180)', roofColor: 'rgb(255, 255, 255)', 
                           strokeRoofs: true })
        		.geoJSON(data)
			;	

	};


	var latlon = new L.LatLng(42.07287028, -4.07575607);
	var map = L.map('map').setView(latlon, 18);



	//Add a basemap using OSM data with Cloudmade styling
	var basemap = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});
	
	map.addLayer(basemap);

	//Add scale bar to map
	L.control.scale().addTo(map);

	// Create a buildings layer instance
	var build = new L.BuildingsLayer();
	//map.removeLayer(build);
	
	//Call get bounds and get buildings on page load
	getBuildings(geojsonData);




</script>
</body>
</html>