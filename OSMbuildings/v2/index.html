<!DOCTYPE html>
<html>
	<head>
		<title>3DPeral</title>
		<meta charset="utf-8">
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
		<script src="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.js"></script>
		<script src="http://maps.google.com/maps/api/js?v=3&sensor=false"></script>
  		<script src="../Google.js"></script>
  		<script src="geojson.js"></script>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.css"/>
		<!--[if lte IE 8]>
	    	<	link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.ie.css" />
		<![endif]-->
		<script src="../OSMBuildings-Leaflet.js"></script>

		<style>
		body {
			padding: 0;
			margin: 0;
		}
		html, body, #map {
			height: 100%;
		}
		
	   </style>
	</head>

	<body>


		<div id="map"></div>
		<script>

			var map = new L.Map('map').setView([42.07633450511675, -4.077880382537842], 18);
			var basemap = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});
			
			map.addLayer(basemap);
			
			// add buldings of interest => 3D OSM buildings

			var osmb = new OSMBuildings(map).setData(geojson);

			L.control.layers({}, { Buildings:osmb}).addTo(map);

			// add poligons with popup
			var poligons2D;
			function style(feature) {
			    return {        
			    	fillColor: 'red',
			        weight: 2,
			        opacity: 0.2,
			        color: 'white'
			    };
			}
			poligons2D=L.geoJson(geojson,{
				style: style,
				onEachFeature:onEachFeature
			}).addTo(map)
			function onEachFeature(feature, layer) {
				var popupContent = "<img src='"+feature.properties.photo+ "'alt='building'></br>"+feature.properties.name;
				layer.bindPopup(popupContent, {offset: new L.Point(1, -20)});
				layer.on({
				        mouseover: highlightFeature,
				        mouseout: resetHighlight,
				    });

			}
			function highlightFeature(e) {
			    var layer = e.target;


			    layer.openPopup();

			    if (!L.Browser.ie && !L.Browser.opera) {
			        layer.bringToFront();
			    }
			};
			function resetHighlight(e) {
			    poligons2D.resetStyle(e.target);
			}
		</script>
	</body>
</html>